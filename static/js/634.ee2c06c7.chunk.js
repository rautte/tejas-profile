"use strict";(self.webpackChunktejas_profile=self.webpackChunktejas_profile||[]).push([[634],{634:(n,t,e)=>{e.r(t),e.d(t,{createFirebaseAdapter:()=>p,default:()=>E});var o=e(64),a=e(800);const i=("undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"/tejas-profile",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CDN_BASE:"https://d2n9g8msgr1y81.cloudfront.net"}:{})||{},s=n=>{var t,e;return null!==(t=null!==(e=i[`REACT_APP_FIREBASE_${n}`])&&void 0!==e?e:i[`VITE_FIREBASE_${n}`])&&void 0!==t?t:void 0};let c=null,r=null;function u(){if(!c){const n=function(){const n="undefined"!==typeof window&&(window.__FIREBASE||window.__FZ_FB__)||{},t={apiKey:s("API_KEY"),authDomain:s("AUTH_DOMAIN"),projectId:s("PROJECT_ID"),databaseURL:s("DATABASE_URL"),storageBucket:s("STORAGE_BUCKET"),messagingSenderId:s("MESSAGING_SENDER_ID"),appId:s("APP_ID"),...n},e=["apiKey","projectId","appId"].filter(n=>!t[n]);if(e.length)throw new Error(`[Firebase config] Missing: ${e.join(", ")}. Provide window.__FIREBASE in public/index.html or .env values.`);return t}();c=(0,o.Dk)()[0]||(0,o.Wp)(n),r=(0,a.C3)(c)}return{app:c,db:r}}const d=n=>`rooms/${n}/meta/state`,l=(n,t)=>`rooms/${n}/epochs/${t}/events`;async function _(n,t,e,o){const i=(0,a.KR)(n,l(t,e));await(0,a.VC)(i,{...o,at:(0,a.O5)(),atClient:Date.now()})}function p(){const{db:n}=u();let t="",e=0,o=null,i=()=>{};function s(e){o&&(o(),o=null);const s=(0,a.P)((0,a.KR)(n,l(t,e)),(0,a.JK)()),c=(0,a._O)(s,n=>{var t;const e=n.val(),o={...e,at:null!==(t=null===e||void 0===e?void 0:e.atClient)&&void 0!==t?t:Date.now()};i(o)});o=()=>{c(),(0,a.AU)(s)}}return{connect:async(o,c,r)=>(t=o.toUpperCase(),i=r,e=await async function(n,t){const e=(0,a.KR)(n,d(t)),o=await(0,a.Jt)(e);if(!o.exists())return await(0,a.hZ)(e,{epoch:0,createdAt:(0,a.O5)()}),0;const i=o.val()||{};return"number"===typeof i.epoch?i.epoch:0}(n,t),s(e),e),async send(o){await _(n,t,e,o)},async bumpEpoch(){const o=e+1;return await async function(n,t,e){const o=(0,a.KR)(n,d(t));await(0,a.hZ)(o,{epoch:e,updatedAt:(0,a.O5)()})}(n,t,o),e=o,s(e),await _(n,t,e,{t:"epoch",n:e,at:Date.now()}),e},async leave(){o&&(o(),o=null)}}}const E=p}}]);
//# sourceMappingURL=634.ee2c06c7.chunk.js.map